var thrift = require('thrift');
var HqlService = require('./HqlService');

exports.create = function(host, port, timeout) {
  transport = thrift.TFramedTransport;
  protocol = thrift.TBinaryProtocol;

  var connection = thrift.createConnection(host, port, {
      transport : transport,
      protocol : protocol,
      connect_timeout : timeout,
      timeout : timeout
    });

  connection.on('error', function(err) {
      assert(false, err);
    });

  var client = thrift.createClient(HqlService, connection);
  client.connection = connection;
  client.closeConnection = function() {
    this.connection.end();
  }
  return client;
}
