#!/bin/bash

if [ $# -eq 0 ]; then
    echo "usage: $0 <hypertable-cfg-file>"
    exit 1
fi

HYPERTABLE_CFG_PATH=$1

cd ~hadoop
rm -f hypertable.cfg
aws s3 cp $HYPERTABLE_CFG_PATH hypertable.cfg
if [ $? -ne 0 ]; then
  echo "Failed to fetch hypertable config file '$HYPERTABLE_CFG_PATH'"
  exit 1
fi
cp hypertable.cfg /opt/hypertable/current/conf/
chown hadoop:hadoop /opt/hypertable/current/conf/hypertable.cfg

